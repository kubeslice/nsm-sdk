# Metadata helper

Metadata helper is a [genny](https://github.com/cheekybits/genny) template to generate a helper class for the metadata
usage. Template parameters are:
* prefix - prefix for the metadata type and constructor;
* valueType - stored type.
Generated helpers can both be exported (**P**refix) and unexported (**p**refix).

gen.go:
```go
package connect

//go:generate bash -c "genny -in=$(go list -f '{{.Dir}} github.com/networkservicemesh/sdk/pkg/tools/metadatahelper)/meta_data.template.go -out=client_meta_data.gen.go -pkg=$GOPACKAGE gen 'prefix=client valueType=networkservice.NetworkServiceClient'"
```
client_meta_data.gen.go:
```go
// This file was automatically generated by genny.
// Any changes will be lost if this file is regenerated.
// see https://github.com/cheekybits/genny

package connect

import (
	"context"
	"sync"

	"github.com/networkservicemesh/api/pkg/api/networkservice"
	"github.com/networkservicemesh/sdk/pkg/networkservice/utils/metadata"
)

type _ClientKeyType struct{}

type clientMetadataHelper struct {
	m *sync.Map
}

func clientMetadata(ctx context.Context, isClient bool) *clientMetadataHelper {
	return &clientMetadataHelper{
		m: metadata.Map(ctx, isClient),
	}
}

func (h *clientMetadataHelper) Store(value networkservice.NetworkServiceClient) {
	h.m.Store(_ClientKeyType{}, value)
}

func (h *clientMetadataHelper) LoadOrStore(value networkservice.NetworkServiceClient) (networkservice.NetworkServiceClient, bool) {
	raw, ok := h.m.LoadOrStore(_ClientKeyType{}, value)
	return raw.(networkservice.NetworkServiceClient), ok
}

func (h *clientMetadataHelper) Load() (networkservice.NetworkServiceClient, bool) {
	if raw, ok := h.m.Load(_ClientKeyType{}); ok {
		return raw.(networkservice.NetworkServiceClient), true
	}
	return func() (v networkservice.NetworkServiceClient) { return }(), false
}

func (h *clientMetadataHelper) LoadAndDelete() (networkservice.NetworkServiceClient, bool) {
	if raw, ok := h.m.LoadAndDelete(_ClientKeyType{}); ok {
		return raw.(networkservice.NetworkServiceClient), true
	}
	return func() (v networkservice.NetworkServiceClient) { return }(), false
}

func (h *clientMetadataHelper) Delete() {
	h.m.Delete(_ClientKeyType{})
}
```
